1. Подумать над правильным способом отключения пользователя.

2. Добавить события: "user вступил в группу", "user вышел из группы"
3. Триггер онлайна
4. Триггер доставленно и прочитанно 


Presence Service.

type Presence struct {
    UserID int
    Presence bool
    Timestamp time.Time
}

1. Запрос на изменение статуса пользователя
2. Для подписки заинтересованных пользователей

Служба Heartbeat.
1. Переодические проверяет состояние подключения пользователя и каждую d секунду отправялет сигнал Heartbeat обработчику.
Если обработчик получает сигнал Heartbeat:
Ключ user_a не существует или diff(<last_active_timestamp>, heartbeat_timestamp) > d + (дельта) секунд. --> Пользователь user_a снова в сети. Нам нужно 1) обновить отметку времени последнего активного сеанса, 2) отправить уведомление об изменении статуса.
В остальных случаях просто обновите отметку времени последнего активного сеанса и сбросьте таймер. (При нестабильном соединении отправлять уведомления не нужно)
Если обработчик сердцебиения НЕ получает сигнал сердцебиения в течение времени d + (2*delta):
(У одного пользователя установлен таймер)
Таймер истек, что означает, что пользователь не в сети.
Вызовите платформу реального времени, чтобы сообщить о том, что пользователь не в сети.